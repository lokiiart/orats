(function(){if(typeof window.monitor!="undefined")return;var e="V1.2.6(2013.01.30)",t="360.cn",n=function(r,i){var s=document,o=navigator,u=r.screen,a=document.domain.toLowerCase(),f=o.userAgent.toLowerCase(),l={trim:function(e){return e.replace(/^[\s\xa0\u3000]+|[\u3000\xa0\s]+$/g,"")}},c={on:function(e,t,n){e.addEventListener?e&&e.addEventListener(t,n,!1):e&&e.attachEvent("on"+t,n)},parentNode:function(e,t,n){n=n||5,t=t.toUpperCase();while(e&&n-->0){if(e.tagName===t)return e;e=e.parentNode}return null}},h={fix:function(e){if(!("target"in e)){var t=e.srcElement||e.target;t&&t.nodeType==3&&(t=t.parentNode),e.target=t}return e}},p=function(){function e(e){return e!=null&&e.constructor!=null?Object.prototype.toString.call(e).slice(8,-1):""}return{isArray:function(t){return e(t)=="Array"},isObject:function(e){return e!==null&&typeof e=="object"},mix:function(e,t,n){for(var r in t)if(n||!(e[r]||r in e))e[r]=t[r];return e},encodeURIJson:function(e){var t=[];for(var n in e){if(e[n]==null)continue;t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]))}return t.join("&")}}}(),d={get:function(e){var t,n=new RegExp("(^| )"+e+"=([^;]*)(;|$)");return(t=s.cookie.match(n))?unescape(t[2]):""},set:function(e,t,n){n=n||{};var r=n.expires;typeof r=="number"&&(r=new Date,r.setTime(r.getTime()+n.expires)),s.cookie=e+"="+escape(t)+(r?";expires="+r.toGMTString():"")+(n.path?";path="+n.path:"")+(n.domain?"; domain="+n.domain:"")}},v={getProject:function(){return""},getReferrer:function(){return s.referrer},getBrowser:function(){var e={"360se-ua":"360se",TT:"tencenttraveler",Maxthon:"maxthon",GreenBrowser:"greenbrowser",Sogou:"se 1.x / se 2.x",TheWorld:"theworld"};for(var t in e)if(f.indexOf(e[t])>-1)return t;var n=!1;try{+external.twGetVersion(external.twGetSecurityID(r)).replace(/\./g,"")>1013&&(n=!0)}catch(i){}if(n)return"360se-noua";var s=f.match(/(msie|chrome|safari|firefox|opera)/);return s=s?s[0]:"",s=="msie"&&(s=f.match(/msie[^;]+/)),s},getLocation:function(){var e="";try{e=location.href}catch(t){e=s.createElement("a"),e.href="",e=e.href}return e=e.replace(/[?#].*$/,""),e=/\.(s?htm|php)/.test(e)?e:e.replace(/\/$/,"")+"/",e},getGuid:function(){function e(e){var t=0,n=0,r=e.length-1;for(r;r>=0;r--){var i=parseInt(e.charCodeAt(r),10);t=(t<<6&268435455)+i+(i<<14),(n=t&266338304)!=0&&(t^=n>>21)}return t}function n(){var t=[o.appName,o.version,o.language||o.browserLanguage,o.platform,o.userAgent,u.width,"x",u.height,u.colorDepth,s.referrer].join(""),n=t.length,i=r.history.length;while(i)t+=i--^n++;return(Math.round(Math.random()*2147483647)^e(t))*2147483647}var i="__guid",f=d.get(i);if(!f){f=[e(s.domain),n(),+(new Date)+Math.random()+Math.random()].join(".");var l={expires:2592e7,path:"/"};if(t){var c="."+t;if(a.indexOf(c)>0&&a.lastIndexOf(c)==a.length-c.length||a==c)l.domain=c}d.set(i,f,l)}return function(){return f}}(),getCount:function(){var e="count",t=d.get(e);return t=(parseInt(t)||0)+1,d.set(e,t,{expires:864e5,path:"/"}),function(){return t}}(),getFlashVer:function(){var e=-1;if(o.plugins&&o.mimeTypes.length){var t=o.plugins["Shockwave Flash"];t&&t.description&&(e=t.description.replace(/([a-zA-Z]|\s)+/,"").replace(/(\s)+r/,".")+".0")}else if(r.ActiveXObject&&!r.opera)try{var n=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");if(n){var i=n.GetVariable("$version");e=i.replace(/WIN/g,"").replace(/,/g,".")}}catch(s){}return e=parseInt(e,10),e},getContainerId:function(e){var t=g.areaIds;if(t){var n,r=new RegExp("^("+t.join("|")+")$","ig");while(e){if(e.id&&r.test(e.id))return(e.getAttribute("data-desc")||e.id).substr(0,100);e=e.parentNode}}return""},getText:function(e){var t="";return e.tagName.toLowerCase()=="input"?t=e.getAttribute("text")||e.getAttribute("data-text")||e.value||e.title||"":t=e.getAttribute("text")||e.getAttribute("data-text")||e.innerText||e.textContent||e.title||"",l.trim(t).substr(0,100)},getHref:function(e){try{return e.getAttribute("data-href")||e.href||""}catch(t){return""}}},m={getBase:function(){return{p:v.getProject(),u:v.getLocation(),id:v.getGuid(),guid:v.getGuid()}},getTrack:function(){return{b:v.getBrowser(),c:v.getCount(),r:v.getReferrer(),fl:v.getFlashVer()}},getClick:function(e){e=h.fix(e||event);var t=e.target,n=t.tagName,r=v.getContainerId(t);if(!t.type||t.type!="submit"&&t.type!="button"){if(n=="AREA")return{f:v.getHref(t),c:"area:"+t.parentNode.name,cId:r};var f,l;return n=="IMG"&&(f=t),t=c.parentNode(t,"A"),t?(l=v.getText(t),{f:v.getHref(t),c:l?l:f?f.src.match(/[^\/]+$/):"",cId:r}):!1}var i=c.parentNode(t,"FORM"),s={};if(i){var o=i.id||"",u=t.id;s={f:i.action,c:"form:"+(i.name||o),cId:r};if((o=="search-form"||o=="searchForm")&&(u=="searchBtn"||u=="search-btn")){var a=y("kw")||y("search-kw")||y("kw1");s.w=a?a.value:""}}else s={f:v.getHref(t),c:v.getText(t),cId:r};return s},getKeydown:function(e){e=h.fix(e||event);if(e.keyCode!=13)return!1;var t=e.target,n=t.tagName,r=v.getContainerId(t);if(n=="INPUT"){var i=c.parentNode(t,"FORM");if(i){var s=i.id||"",o=t.id,u={f:i.action,c:"form:"+(i.name||s),cId:r};if(o=="kw"||o=="search-kw"||o=="kw1")u.w=t.value;return u}}return!1}},g={trackUrl:null,clickUrl:null,areaIds:null},y=function(e){return document.getElementById(e)};return{version:e,util:v,data:m,config:g,sendLog:function(){return r.__monitor_imgs={},function(e){var t="log_"+ +(new Date),n=r.__monitor_imgs[t]=new Image;n.onload=n.onerror=function(){r.__monitor_imgs[t]=null,delete r.__monitor_imgs[t]},n.src=e}}(),buildLog:function(){var e="";return function(t,n){if(t===!1)return;t=t||{};var r=m.getBase();t=p.mix(r,t,!0);var i=n+p.encodeURIJson(t);if(i==e)return;e=i,setTimeout(function(){e=""},500);var s=p.encodeURIJson(t);s+="&t="+ +(new Date),n=n.indexOf("?")>-1?n+"&"+s:n+"?"+s,this.sendLog(n)}}(),log:function(e,t){t=t||"click";var n=g[t+"Url"];n||alert("Error : the "+t+"url does not exist!"),this.buildLog(e,n)},setConf:function(e,t){var n={};return p.isObject(e)?n=e:n[e]=t,this.config=p.mix(this.config,n,!0),this},setUrl:function(e){return e&&(this.util.getLocation=function(){return e}),this},setProject:function(e){return e&&(this.util.getProject=function(){return e}),this},setId:function(){var e=[],t=0,n;while(n=arguments[t++])p.isArray(n)?e=e.concat(n):e.push(n);return this.setConf("areaIds",e),this},getTrack:function(){var e=this.data.getTrack();return this.log(e,"track"),this},getClickAndKeydown:function(){var e=this;return c.on(s,"mousedown",function(t){var n=e.data.getClick(t);e.log(n,"click")}),c.on(s,"keydown",function(t){var n=e.data.getKeydown(t);e.log(n,"click")}),n.getClickAndKeydown=function(){return e},this}}}(window);n.setConf({trackUrl:"http://s.360.cn/w360/s.htm",clickUrl:"http://s.360.cn/w360/c.htm",wpoUrl:"http://s.360.cn/w360/p.htm"}),window.monitor=n})();